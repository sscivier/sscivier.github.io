<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sam A. Scivier</title>
  <meta name="description" content="Personal website for Sam A. Scivier — research, publications, software, and contact." />
  <meta property="og:title" content="Sam A. Scivier" />
  <meta property="og:description" content="Research, publications, software, and contact." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://sscivier.github.io" />
  <meta name="theme-color" content="#0ea5e9" />
  <script>
    // Respect user's system preference and remember toggle
    const savedTheme = localStorage.getItem('theme');
    if (
      savedTheme === 'dark' ||
      (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      document.documentElement.classList.add('dark');
    }
  </script>
  <!-- TailwindCSS CDN (no build step required) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind config for fonts & colors
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'Avenir', 'Helvetica', 'Arial', 'sans-serif'],
          },
          colors: {
            brand: {
              DEFAULT: '#0ea5e9',
              dark: '#0284c7',
              light: '#7dd3fc',
            },
          },
          boxShadow: {
            soft: '0 8px 30px rgba(0,0,0,0.06)',
          },
        }
      },
      darkMode: 'class'
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Subtle animated gradient background */
    .bg-grid {
      background-image: radial-gradient(rgba(0,0,0,0.05) 1px, transparent 1px);
      background-size: 16px 16px;
    }
    .dark .bg-grid { background-image: radial-gradient(rgba(255,255,255,0.06) 1px, transparent 1px); }
  </style>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Sam A. Scivier",
    "url": "https://sscivier.github.io",
    "sameAs": [
      "https://github.com/sscivier",
      "https://scholar.google.com/citations?user=aAvhqzIAAAAJ&hl=en",
      "https://www.earth.ox.ac.uk/people/sam-scivier",
      "https://www.linkedin.com/in/samscivier/",
    ]
  }
  </script>
</head>
<body class="font-sans antialiased text-slate-800 dark:text-slate-200 bg-[#fbf7ee] dark:bg-slate-900">
  <!-- Header -->
  <header class="sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/70 dark:supports-[backdrop-filter]:bg-slate-900/70 border-b border-slate-200/60 dark:border-slate-800/60">
    <div class="max-w-6xl mx-auto px-4">
      <div class="flex items-center justify-between h-16">
        <!-- Logo -->
        <a href="#home" class="flex items-center gap-3 group">
          <div class="h-9 w-9 rounded-2xl bg-brand/10 border border-slate-200 dark:border-slate-700 overflow-hidden group-hover:bg-brand/20 transition">
            <img src="/assets/img/me.jpg" alt="Sam Scivier" class="w-full h-full object-cover object-center" />
          </div>
          <span class="font-semibold">Sam A. Scivier</span>
        </a>

        <!-- Desktop Navigation -->
        <nav class="hidden md:flex items-center gap-6 text-sm">
          <a href="#research" class="hover:text-brand transition-colors">Research</a>
          <a href="#publications" class="hover:text-brand transition-colors">Publications</a>
          <a href="#software" class="hover:text-brand transition-colors">Software</a>
          <a href="#teaching" class="hover:text-brand transition-colors">Teaching</a>
          <a href="#contact" class="hover:text-brand transition-colors">Contact</a>
        </nav>

        <!-- Desktop Actions -->
        <div class="hidden md:flex items-center gap-2">
          <button id="themeToggle" class="p-2 rounded-xl hover:bg-slate-200/60 dark:hover:bg-slate-800/60 transition-colors" aria-label="Toggle dark mode">
            <svg id="sun" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden dark:inline" viewBox="0 0 24 24" fill="currentColor"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.8 1.42-1.42zm10.48 14.32l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM12 4V1h-0v3h0zm0 19v-3h0v3h0zM4 12H1v0h3v0zm19 0h-3v0h3v0zM6.76 19.16l-1.42 1.42-1.79-1.8 1.41-1.41 1.8 1.79zM19.16 6.76l1.4-1.4 1.8 1.79-1.41 1.41-1.79-1.8zM12 6a6 6 0 100 12 6 6 0 000-12z"/></svg>
            <svg id="moon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 dark:hidden" viewBox="0 0 24 24" fill="currentColor"><path d="M21.64 13A9 9 0 1111 2.36a7 7 0 1010.64 10.64z"/></svg>
          </button>
          <a href="https://github.com/sscivier" class="p-2 rounded-xl hover:bg-slate-200/60 dark:hover:bg-slate-800/60 transition-colors" aria-label="GitHub">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-5 w-5" fill="currentColor"><path d="M12 .5a12 12 0 00-3.79 23.4c.6.1.82-.26.82-.58v-2.03c-3.34.73-4.04-1.61-4.04-1.61-.55-1.39-1.36-1.76-1.36-1.76-1.11-.76.08-.74.08-.74 1.23.09 1.88 1.26 1.88 1.26 1.09 1.87 2.86 1.33 3.55 1.02.11-.8.43-1.33.78-1.64-2.66-.3-5.46-1.34-5.46-5.98 0-1.32.47-2.4 1.24-3.25-.12-.3-.54-1.5.12-3.12 0 0 1-.32 3.3 1.24a11.44 11.44 0 016 0c2.3-1.56 3.3-1.24 3.3-1.24.66 1.62.24 2.82.12 3.12.77.85 1.24 1.93 1.24 3.25 0 4.66-2.8 5.67-5.48 5.98.44.38.83 1.12.83 2.26v3.35c0 .32.21.69.83.58A12 12 0 0012 .5z"/></svg>
          </a>
          <a href="https://scholar.google.com/citations?user=aAvhqzIAAAAJ&hl=en" class="p-2 rounded-xl hover:bg-slate-200/60 dark:hover:bg-slate-800/60 transition-colors" aria-label="Google Scholar">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-5 w-5" fill="currentColor"><path d="M12 24a7 7 0 1 1 0-14 7 7 0 0 1 0 14zm0-24L0 9.5l4.838 3.94A8 8 0 0 1 12 9a8 8 0 0 1 7.162 4.44L24 9.5z"/></svg>
          </a>
          <a href="https://www.linkedin.com/in/samscivier/" class="p-2 rounded-xl hover:bg-slate-200/60 dark:hover:bg-slate-800/60 transition-colors" aria-label="LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-5 w-5" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          </a>
        </div>

        <!-- Mobile Actions & Menu Button -->
        <div class="flex items-center gap-2 md:hidden">
          <button id="themeToggleMobile" class="p-2 rounded-xl hover:bg-slate-200/60 dark:hover:bg-slate-800/60 transition-colors" aria-label="Toggle dark mode">
            <svg class="sun-mobile h-5 w-5 hidden dark:inline" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.8 1.42-1.42zm10.48 14.32l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM12 4V1h-0v3h0zm0 19v-3h0v3h0zM4 12H1v0h3v0zm19 0h-3v0h3v0zM6.76 19.16l-1.42 1.42-1.79-1.8 1.41-1.41 1.8 1.79zM19.16 6.76l1.4-1.4 1.8 1.79-1.41 1.41-1.79-1.8zM12 6a6 6 0 100 12 6 6 0 000-12z"/></svg>
            <svg class="moon-mobile h-5 w-5 dark:hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M21.64 13A9 9 0 1111 2.36a7 7 0 1010.64 10.64z"/></svg>
          </button>
          <button id="mobileMenuToggle" class="p-2 rounded-xl hover:bg-slate-200/60 dark:hover:bg-slate-800/60 transition-colors" aria-label="Toggle menu" aria-expanded="false">
            <svg class="menu-icon h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            <svg class="close-icon h-6 w-6 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Mobile Navigation Menu -->
      <div id="mobileMenu" class="hidden md:hidden border-t border-slate-200/60 dark:border-slate-800/60 bg-white/95 dark:bg-slate-900/95 backdrop-blur">
        <nav class="py-4 space-y-1">
          <a href="#research" class="block px-4 py-3 text-sm hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-brand transition-colors">Research</a>
          <a href="#publications" class="block px-4 py-3 text-sm hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-brand transition-colors">Publications</a>
          <a href="#software" class="block px-4 py-3 text-sm hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-brand transition-colors">Software</a>
          <a href="#teaching" class="block px-4 py-3 text-sm hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-brand transition-colors">Teaching</a>
          <a href="#contact" class="block px-4 py-3 text-sm hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-brand transition-colors">Contact</a>
          <div class="flex items-center justify-center gap-4 pt-4 border-t border-slate-200/60 dark:border-slate-800/60">
            <a href="https://github.com/sscivier" class="p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors" aria-label="GitHub">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6" fill="currentColor"><path d="M12 .5a12 12 0 00-3.79 23.4c.6.1.82-.26.82-.58v-2.03c-3.34.73-4.04-1.61-4.04-1.61-.55-1.39-1.36-1.76-1.36-1.76-1.11-.76.08-.74.08-.74 1.23.09 1.88 1.26 1.88 1.26 1.09 1.87 2.86 1.33 3.55 1.02.11-.8.43-1.33.78-1.64-2.66-.3-5.46-1.34-5.46-5.98 0-1.32.47-2.4 1.24-3.25-.12-.3-.54-1.5.12-3.12 0 0 1-.32 3.3 1.24a11.44 11.44 0 016 0c2.3-1.56 3.3-1.24 3.3-1.24.66 1.62.24 2.82.12 3.12.77.85 1.24 1.93 1.24 3.25 0 4.66-2.8 5.67-5.48 5.98.44.38.83 1.12.83 2.26v3.35c0 .32.21.69.83.58A12 12 0 0012 .5z"/></svg>
            </a>
            <a href="https://scholar.google.com/citations?user=aAvhqzIAAAAJ&hl=en" class="p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors" aria-label="Google Scholar">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6" fill="currentColor"><path d="M12 24a7 7 0 1 1 0-14 7 7 0 0 1 0 14zm0-24L0 9.5l4.838 3.94A8 8 0 0 1 12 9a8 8 0 0 1 7.162 4.44L24 9.5z"/></svg>
            </a>
            <a href="https://www.linkedin.com/in/samscivier/" class="p-3 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors" aria-label="LinkedIn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
          </div>
        </nav>
      </div>
    </div>
    </div>
  </header>

  <!-- Development Banner -->
  <div class="sticky top-16 z-30 bg-amber-50 dark:bg-amber-900/20 border-b border-amber-200 dark:border-amber-800/40">
  <div class="max-w-6xl mx-auto px-4 py-2">
      <div class="flex items-center justify-center gap-2 text-sm text-amber-800 dark:text-amber-200">
        <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
        </svg>
        <span class="font-medium">Website Under Development</span>
        <span class="hidden sm:inline">— Content and features are being updated</span>
      </div>
    </div>
  </div>

  <!-- Hero (hybrid: full-bleed background, centered content) -->
  <section id="home" class="relative overflow-hidden">
    <!-- full-bleed background layer -->
    <div class="absolute inset-0 bg-grid pointer-events-none" aria-hidden="true"></div>
    <!-- centered content column inside the full-bleed area -->
    <div class="max-w-6xl mx-auto px-4 pt-8 md:pt-16 pb-12 md:pb-20">
  <div class="grid md:grid-cols-2 gap-8 md:gap-10 items-center">
  <div class="order-2 md:order-1 md:pr-8 text-center md:text-left">
          <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold leading-tight tracking-tight">
            Sam A. Scivier <span class="text-sm sm:text-base md:text-xl font-normal text-slate-600 dark:text-slate-300 block sm:inline sm:ml-3 mt-1 sm:mt-0">(he / him)</span>
          </h1>
          <p class="mt-4 text-base md:text-lg text-slate-600 dark:text-slate-300 max-w-prose leading-relaxed mx-auto md:mx-0">
            I am a PhD student in the <a href="https://www.earth.ox.ac.uk/" class="hover:text-brand transition-colors" target="_blank" rel="noopener noreferrer">Department of Earth Sciences</a> at the <a href="https://www.ox.ac.uk/" class="hover:text-brand transition-colors" target="_blank" rel="noopener noreferrer">University of Oxford</a>, developing probabilistic methods to improve uncertainty quantification in geophysics. My PhD is funded by the <a href="https://www.environmental-research.ox.ac.uk/" class="hover:text-brand transition-colors" target="_blank" rel="noopener noreferrer">Oxford‑NERC DTP in Environmental Research</a>. I hold a Master's in Physics from the <a href="https://www.birmingham.ac.uk/" class="hover:text-brand transition-colors" target="_blank" rel="noopener noreferrer">University of Birmingham</a>. Alongside my studies at Birmingham, I completed internships in quantum computing at <a href="https://www.dwavesys.com/" class="hover:text-brand transition-colors" target="_blank" rel="noopener noreferrer">D‑Wave Systems</a> (Burnaby, Canada) and <a href="https://www.riverlane.com/" class="hover:text-brand transition-colors" target="_blank" rel="noopener noreferrer">Riverlane</a> (Cambridge, UK).
          </p>
          <div class="mt-6 flex flex-col sm:flex-row sm:flex-wrap gap-3 justify-center md:justify-start">
            <a href="#publications" class="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-3 bg-brand text-white hover:bg-brand-dark shadow-soft transition-colors">
              View Publications
            </a>
            <a href="https://www.earth.ox.ac.uk/people/sam-scivier" class="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-3 border border-slate-300/70 dark:border-slate-700/70 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
              Department Page
            </a>
            <a href="https://scholar.google.com/citations?user=aAvhqzIAAAAJ&hl=en" class="inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-3 border border-slate-300/70 dark:border-slate-700/70 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
              Google Scholar
            </a>
          </div>
        </div>
        <div class="relative order-1 md:order-2 flex justify-center md:justify-end">
          <div class="w-48 sm:w-56 md:w-full rounded-3xl bg-gradient-to-br from-brand/20 to-transparent border border-slate-200 dark:border-slate-800 overflow-hidden" style="aspect-ratio: 4/5; max-width:100%;">
            <!-- Profile image: replace /assets/img/me.jpg with your photo file -->
            <img src="/assets/img/me.jpg" alt="Sam Scivier" class="w-full h-full object-cover" />
          </div>
        </div>
      </div>
  </div>
  </section>

  <!-- Research -->
  <section id="research" class="py-16 border-t border-slate-200/60 dark:border-slate-800/60">
  <div class="max-w-5xl mx-auto px-4">
      <div class="max-w-5xl">
        <h2 class="text-2xl font-semibold text-center md:text-left">Research</h2>
        <p class="mt-4 text-slate-600 dark:text-slate-300">...</p>
        <ul class="mt-6 grid sm:grid-cols-2 gap-4">
          <li class="p-5 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800/50 text-center md:text-left">
            <h3 class="font-medium">My PhD</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300 mt-1">...</p>
          </li>
          <li class="p-5 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800/50 text-center md:text-left">
            <h3 class="font-medium">Broader interests</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300 mt-1">...</p>
          </li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Publications -->
  <section id="publications" class="py-16 border-t border-slate-200/60 dark:border-slate-800/60">
  <div class="max-w-5xl mx-auto px-4">
      <div class="max-w-5xl">
        <div class="flex flex-col items-center md:flex-row md:items-center md:justify-between gap-4 mb-4">
          <h2 class="text-2xl font-semibold text-center md:text-left">Selected Publications</h2>
          <a class="text-sm underline hover:text-brand text-center" href="https://scholar.google.com/citations?user=aAvhqzIAAAAJ&hl=en">Full list on Google Scholar →</a>
        </div>

        <!-- Filter buttons -->
        <div id="pub-filters" class="mt-4 flex flex-wrap gap-2 justify-center md:justify-start" role="tablist" aria-label="Filter publications">
          <button type="button" class="pub-filter px-3 py-1.5 rounded-xl border border-slate-300/70 dark:border-slate-700/70 text-sm hover:bg-slate-100 dark:hover:bg-slate-800 bg-brand text-white" data-filter="all" aria-pressed="true">All</button>
          <button type="button" class="pub-filter px-3 py-1.5 rounded-xl border border-slate-300/70 dark:border-slate-700/70 text-sm hover:bg-slate-100 dark:hover:bg-slate-800" data-filter="article" aria-pressed="false">Journal Articles</button>
          <button type="button" class="pub-filter px-3 py-1.5 rounded-xl border border-slate-300/70 dark:border-slate-700/70 text-sm hover:bg-slate-100 dark:hover:bg-slate-800" data-filter="inproceedings" aria-pressed="false">Conference Papers</button>
          <button type="button" class="pub-filter px-3 py-1.5 rounded-xl border border-slate-300/70 dark:border-slate-700/70 text-sm hover:bg-slate-100 dark:hover:bg-slate-800" data-filter="preprint" aria-pressed="false">Preprints</button>
        </div>

        <div id="pubs" class="mt-6 grid gap-4"></div>
      </div>
    </div>

  <!-- Publications are loaded from /bib/publications.bib and rendered by JS -->
  </section>

  <!-- Software -->
  <section id="software" class="py-16 border-t border-slate-200/60 dark:border-slate-800/60">
  <div class="max-w-5xl mx-auto px-4">
  <div class="max-w-full">
        <div class="flex flex-col md:flex-row items-center md:justify-between gap-4">
          <h2 class="text-2xl font-semibold text-center md:text-left">Open‑Source Software</h2>
          <a href="https://github.com/sscivier" class="text-sm underline hover:text-brand">See more @sscivier on GitHub →</a>
        </div>
        <div class="mt-6 grid md:grid-cols-2 gap-4" id="repos">
          <div class="p-5 rounded-2xl border border-slate-200 dark:border-slate-800 text-center">
            <div class="text-sm text-slate-500">Loading repositories...</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Teaching -->
  <section id="teaching" class="py-16 border-t border-slate-200/60 dark:border-slate-800/60">
  <div class="max-w-5xl mx-auto px-4">
      <div class="max-w-5xl">
        <h2 class="text-2xl font-semibold text-center md:text-left">Teaching & Outreach</h2>
        <ul class="mt-6 space-y-3">
          <li class="p-5 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800/50">
            <div class="font-medium">Course or tutorial</div>
            <div class="text-sm text-slate-600 dark:text-slate-300">Institution • Year • short description</div>
          </li>
          <li class="p-5 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800/50">
            <div class="font-medium">Talk or workshop</div>
            <div class="text-sm text-slate-600 dark:text-slate-300">Event • Year • short description</div>
          </li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="py-16 border-t border-slate-200/60 dark:border-slate-800/60">
  <div class="max-w-5xl mx-auto px-4">
      <div class="grid md:grid-cols-2 gap-10 items-start">
        <div class="text-center md:text-left">
          <h2 class="text-2xl font-semibold">Contact</h2>
          <p class="mt-4 text-slate-600 dark:text-slate-300">If you'd like to get in touch, please email me at:</p>
          <ul class="mt-6 space-y-2 text-sm">
            <li><span id="email-contact" class="hover:text-brand cursor-pointer">sam.scivier [at] earth.ox.ac.uk</span></li>
          </ul>
        </div>
        <div class="p-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800/50 text-center md:text-left">
          <h3 class="font-medium">Short Bio</h3>
          <p class="mt-3 text-sm text-slate-700 dark:text-slate-300">Write 3–4 sentences about your background, current position, and interests. You can copy from your department page and tweak for tone.</p>
          <div class="mt-4 flex flex-wrap gap-2 text-xs text-slate-600 dark:text-slate-400">
            <span class="px-2 py-1 rounded-full bg-white/80 dark:bg-slate-900/40 border border-slate-200 dark:border-slate-800">Earth Sciences</span>
            <span class="px-2 py-1 rounded-full bg-white/80 dark:bg-slate-900/40 border border-slate-200 dark:border-slate-800">Research</span>
            <span class="px-2 py-1 rounded-full bg-white/80 dark:bg-slate-900/40 border border-slate-200 dark:border-slate-800">Open‑source</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="py-10 border-t border-slate-200/60 dark:border-slate-800/60">
  <div class="max-w-6xl mx-auto px-4 text-sm text-slate-500 dark:text-slate-400">
      <div class="flex flex-col items-center justify-center gap-2 sm:flex-row sm:items-center sm:justify-between sm:gap-4">
        <p>© <span id="y"></span> Sam A. Scivier</p>
        <div class="flex items-center gap-4">
          <a class="underline hover:text-brand transition-colors" href="/cv.pdf">CV</a>
          <a class="underline hover:text-brand transition-colors" href="#home">Back to top ↑</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Theme toggle for desktop
    document.getElementById('themeToggle').addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    // Theme toggle for mobile
    document.getElementById('themeToggleMobile').addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    // Mobile menu toggle
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    const menuIcon = mobileMenuToggle.querySelector('.menu-icon');
    const closeIcon = mobileMenuToggle.querySelector('.close-icon');

    mobileMenuToggle.addEventListener('click', () => {
      const isOpen = !mobileMenu.classList.contains('hidden');
      
      if (isOpen) {
        // Close menu
        mobileMenu.classList.add('hidden');
        menuIcon.classList.remove('hidden');
        closeIcon.classList.add('hidden');
        mobileMenuToggle.setAttribute('aria-expanded', 'false');
      } else {
        // Open menu
        mobileMenu.classList.remove('hidden');
        menuIcon.classList.add('hidden');
        closeIcon.classList.remove('hidden');
        mobileMenuToggle.setAttribute('aria-expanded', 'true');
      }
    });

    // Close mobile menu when clicking on navigation links
    mobileMenu.querySelectorAll('a[href^="#"]').forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu.classList.add('hidden');
        menuIcon.classList.remove('hidden');
        closeIcon.classList.add('hidden');
        mobileMenuToggle.setAttribute('aria-expanded', 'false');
      });
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!mobileMenuToggle.contains(e.target) && !mobileMenu.contains(e.target)) {
        if (!mobileMenu.classList.contains('hidden')) {
          mobileMenu.classList.add('hidden');
          menuIcon.classList.remove('hidden');
          closeIcon.classList.add('hidden');
          mobileMenuToggle.setAttribute('aria-expanded', 'false');
        }
      }
    });

    // Year
    document.getElementById('y').textContent = new Date().getFullYear();

    // Email contact - decode and make clickable
    document.getElementById('email-contact').addEventListener('click', () => {
      const user = 'sam.scivier';
      const domain = 'earth.ox.ac.uk';
      window.location.href = 'mailto:' + user + '@' + domain;
    });

    // Ensure links open in a new tab by default (skip in-page anchors)
    (function enforceNewTabLinks(){
      try {
        document.querySelectorAll('a[href]').forEach(a => {
          const href = a.getAttribute('href') || '';
          // skip same-page anchors
          if (href.startsWith('#')) return;
          // allow explicit opt-out by data attribute
          if (a.hasAttribute('data-same-tab')) return;
          a.target = '_blank';
          // preserve any existing rel values while ensuring noopener noreferrer
          const rel = (a.getAttribute('rel') || '').split(/\s+/).filter(Boolean);
          if (!rel.includes('noopener')) rel.push('noopener');
          if (!rel.includes('noreferrer')) rel.push('noreferrer');
          a.setAttribute('rel', rel.join(' '));
        });
      } catch (e) {
        console.warn('Could not enforce new-tab links', e);
      }
    })();

  // Publications: fetch, parse BibTeX, convert LaTeX accents, format full author list, render cards with DOI/PDF icons, and filter by type.
    (function renderFromBib(){
      const wrap = document.getElementById('pubs');
      if (!wrap) return;

      const escapeHTML = (s = '') => String(s).replace(/[&<>'"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','\'':'&#39;','"':'&quot;'}[c]));

      const latexToUnicode = (s = '') => {
        if (!s) return '';
        // common LaTeX accents -> unicode
        const map = {
          "'": { a: 'á', e: 'é', i: 'í', o: 'ó', u: 'ú', A: 'Á', E: 'É', I: 'Í', O: 'Ó', U: 'Ú' },
          '"': { a: 'ä', e: 'ë', i: 'ï', o: 'ö', u: 'ü', A: 'Ä', E: 'Ë', I: 'Ï', O: 'Ö', U: 'Ü', y: 'ÿ', Y: 'Ÿ' },
          '`': { a: 'à', e: 'è', i: 'ì', o: 'ò', u: 'ù', A: 'À', E: 'È' },
          '^': { a: 'â', e: 'ê', i: 'î', o: 'ô', u: 'û', A: 'Â', E: 'Ê' },
          '~': { n: 'ñ', N: 'Ñ' },
        };

        // replace \i (dotless i)
        s = s.replace(/\\i/g, 'ı');
        s = s.replace(/\\I/g, 'İ');

        // \c{c} -> ç, \c{s} -> ş
        s = s.replace(/\\c\{?s\}?/gi, 'ş');
        s = s.replace(/\\c\{?c\}?/gi, 'ç');

        // generic accent patterns like \'{a} or \'a
        s = s.replace(/\\(["'`^~])\{?([^}])\}?/g, (m, acc, ch) => {
          const table = map[acc];
          if (table && table[ch]) return table[ch];
          return ch;
        });

        // handle sequences like {\'a} or {\"u}
        s = s.replace(/\{\\(["'`^~])\s*([^}])\}/g, (m, acc, ch) => {
          const table = map[acc];
          if (table && table[ch]) return table[ch];
          return ch;
        });

        // remove remaining braces
        s = s.replace(/[{}]/g, '');
        // collapse multiple spaces
        return s.replace(/\s+/g, ' ').trim();
      };

      const parseBib = (text = '') => {
        const entries = [];
        const entryRe = /@([a-zA-Z]+)\s*\{\s*([^,]+),([\s\S]*?)\n\}/g;
        let m;
        while ((m = entryRe.exec(text)) !== null) {
          const type = m[1];
          const key = m[2];
          const body = m[3];
          const fields = {};
          
          // Parse fields with proper brace matching
          let pos = 0;
          while (pos < body.length) {
            // Skip whitespace
            while (pos < body.length && /\s/.test(body[pos])) pos++;
            if (pos >= body.length) break;
            
            // Find field name
            const fieldStart = pos;
            while (pos < body.length && /[a-zA-Z0-9_\-]/.test(body[pos])) pos++;
            if (pos === fieldStart) break;
            const fieldName = body.slice(fieldStart, pos).toLowerCase();
            
            // Skip whitespace and =
            while (pos < body.length && /[\s=]/.test(body[pos])) pos++;
            if (pos >= body.length) break;
            
            let fieldValue = '';
            if (body[pos] === '{') {
              // Parse braced value with proper nesting
              let braceCount = 0;
              const valueStart = pos;
              do {
                if (body[pos] === '{') braceCount++;
                else if (body[pos] === '}') braceCount--;
                pos++;
              } while (pos < body.length && braceCount > 0);
              fieldValue = body.slice(valueStart + 1, pos - 1); // Remove outer braces
            } else if (body[pos] === '"') {
              // Parse quoted value
              pos++; // Skip opening quote
              const valueStart = pos;
              while (pos < body.length && body[pos] !== '"') pos++;
              fieldValue = body.slice(valueStart, pos);
              pos++; // Skip closing quote
            }
            
            if (fieldValue) {
              fields[fieldName] = fieldValue.replace(/\s+/g, ' ').trim();
            }
            
            // Skip comma and whitespace
            while (pos < body.length && /[\s,]/.test(body[pos])) pos++;
          }
          
          fields._type = type;
          fields._key = key;
          entries.push(fields);
        }
        return entries;
      };

      // Determine a display category for filtering
      const getCategory = (p) => {
        const t = (p._type || '').toLowerCase();
        
        // Prioritize explicit BibTeX types first
        if (t === 'inproceedings' || t === 'conference' || t === 'proceedings') return 'inproceedings';
        if (t === 'article') return 'article';
        
        // Then check content for preprints (only if not explicitly typed as conference/article)
        const text = (p.journal || '') + ' ' + (p.note || '') + ' ' + (p.url || '') + ' ' + (p.howpublished || '');
        const arxivMatch = text.match(/arXiv[:\s]?([0-9]{4}\.[0-9]{4,5})(v\d+)?/i);
        const isPreprintKeyword = /\bpreprint\b/i.test(text);
        if (arxivMatch || isPreprintKeyword) return 'preprint';
        
        if (t === 'misc') {
          // Treat misc without arXiv as misc, otherwise caught above as preprint
          return 'misc';
        }
        
        return t || 'other';
      };

      const formatAuthors = (raw = '') => {
        if (!raw) return '';
        // Split by standard BibTeX ' and ' separator
        const authors = raw.split(/ and /i);
        
        // Check if "others" is already in the list
        const hasOthers = authors.some(author => /^\s*others\s*$/i.test(author.replace(/^\{+|}+$/g, '').trim()));
        
        // Remove "others" from the list for processing, we'll handle it separately
        const realAuthors = authors.filter(author => !/^\s*others\s*$/i.test(author.replace(/^\{+|}+$/g, '').trim()));
        
        // Limit to 25 authors, add "and others" if truncated
        const maxAuthors = 25;
        const truncated = realAuthors.length > maxAuthors;
        const displayAuthors = truncated ? realAuthors.slice(0, maxAuthors) : realAuthors;
        
        const formatted = displayAuthors.map(author => {
          // Clean up braces and apply LaTeX conversion
          let name = author.replace(/^\{+|}+$/g, '').trim();
          name = latexToUnicode(name);
          
          // Convert "Last, First Middle" to "First Middle Last"
          if (name.includes(',')) {
            const [last, first] = name.split(',', 2);
            name = `${first.trim()} ${last.trim()}`;
          }
          
          // Add periods to single-letter initials (only ASCII letters to avoid special chars)
          name = name.replace(/\b([A-Z])\b(?![.\u00C0-\u017F])/g, '$1.');
          
          // Bold your surname
          if (/\bscivier\b/i.test(name)) {
            return `<strong>${escapeHTML(name)}</strong>`;
          }
          
          return escapeHTML(name);
        });
        
        // Add "and others" if we truncated the author list OR if "others" was in the original
        if (truncated || hasOthers) {
          formatted.push('and others');
        }
        
        return formatted.join('; ');
      };

  const renderIcons = (p) => {
        const doi = (p.doi || '').replace(/^(doi:\s*)/i,'').trim();
        const url = (p.url || '').trim();
  // detect arXiv id in journal or note or url or howpublished
        let arxivId = '';
  const arxivMatch = (p.journal || p.note || p.url || p.howpublished || '').match(/arXiv[:\s]?([0-9]{4}\.[0-9]{4,5})(v\d+)?/i);
        if (arxivMatch) arxivId = arxivMatch[1];

  const icons = [];
        if (doi) {
          const doiUrl = `https://doi.org/${encodeURIComponent(doi)}`;
          icons.push(`<a href="${doiUrl}" target="_blank" rel="noopener noreferrer" aria-label="DOI" class="inline-flex items-center gap-1 text-xs text-slate-500 hover:text-brand"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 500 500\" class=\"h-5 w-5\" fill=\"currentColor\"><path d=\"M481.765,220.422L276.474,15.123c-16.967-16.918-44.557-16.942-61.559,0.023L9.626,220.422c-12.835,12.833-12.835,33.65,0,46.483c12.843,12.842,33.646,12.842,46.487,0l27.828-27.832v214.872c0,19.343,15.682,35.024,35.027,35.024h74.826v-97.62c0-7.584,6.146-13.741,13.743-13.741h76.352c7.59,0,13.739,6.157,13.739,13.741v97.621h74.813c19.346,0,35.027-15.681,35.027-35.024V239.091l27.812,27.815c6.425,6.421,14.833,9.63,23.243,9.63c8.408,0,16.819-3.209,23.242-9.63C494.609,254.072,494.609,233.256,481.765,220.422z\"></path></svg><span class=\"sr-only\">DOI</span></a>`);
        }
        if (url) {
          icons.push(`<a href="${escapeHTML(url)}" target="_blank" rel="noopener noreferrer" aria-label="Link/PDF" class="inline-flex items-center gap-1 text-xs text-slate-500 hover:text-brand"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 464 512\" class=\"h-5 w-5\" fill=\"currentColor\">` +
            `<path class="st0" d="M378.413,0H208.297h-13.182L185.8,9.314L57.02,138.102l-9.314,9.314v13.176v265.514c0,47.36,38.528,85.895,85.896,85.895h244.811c47.353,0,85.881-38.535,85.881-85.895V85.896C464.294,38.528,425.766,0,378.413,0z M432.497,426.105c0,29.877-24.214,54.091-54.084,54.091H133.602c-29.884,0-54.098-24.214-54.098-54.091V160.591h83.716c24.885,0,45.077-20.178,45.077-45.07V31.804h170.116c29.87,0,54.084,24.214,54.084,54.092V426.105z"/>` +
            `<path class="st0" d="M171.947,252.785h-28.529c-5.432,0-8.686,3.533-8.686,8.825v73.754c0,6.388,4.204,10.599,10.041,10.599c5.711,0,9.914-4.21,9.914-10.599v-22.406c0-0.545,0.279-0.817,0.824-0.817h16.436c20.095,0,32.188-12.226,32.188-29.612C204.136,264.871,192.182,252.785,171.947,252.785z M170.719,294.888h-15.208c-0.545,0-0.824-0.272-0.824-0.81v-23.23c0-0.545,0.279-0.816,0.824-0.816h15.208c8.42,0,13.447,5.027,13.447,12.498C184.167,290,179.139,294.888,170.719,294.888z"/>` +
            `<path class="st0" d="M250.191,252.785h-21.868c-5.432,0-8.686,3.533-8.686,8.825v74.843c0,5.3,3.253,8.693,8.686,8.693h21.868c19.69,0,31.923-6.249,36.81-21.324c1.76-5.3,2.723-11.681,2.723-24.857c0-13.175-0.964-19.557-2.723-24.856C282.113,259.034,269.881,252.785,250.191,252.785z M267.856,316.896c-2.318,7.331-8.965,10.459-18.21,10.459h-9.23c-0.545,0-0.824-0.272-0.824-0.816v-55.146c0-0.545,0.279-0.817,0.824-0.817h9.23c9.245,0,15.892,3.128,18.21,10.46c0.95,3.128,1.62,8.56,1.62,17.93C269.476,308.336,268.805,313.768,267.856,316.896z"/>` +
            `<path class="st0" d="M361.167,252.785h-44.812c-5.432,0-8.7,3.533-8.7,8.825v73.754c0,6.388,4.218,10.599,10.055,10.599c5.697,0,9.914-4.21,9.914-10.599v-26.351c0-0.538,0.265-0.81,0.81-0.81h26.086c5.837,0,9.23-3.532,9.23-8.56c0-5.028-3.393-8.553-9.23-8.553h-26.086c-0.545,0-0.81-0.272-0.81-0.817v-19.425c0-0.545,0.265-0.816,0.81-0.816h32.733c5.572,0,9.245-3.666,9.245-8.553C370.411,256.45,366.738,252.785,361.167,252.785z"/>` +
            `</svg><span class=\"sr-only\">Link</span></a>`);
        } else if (arxivId) {
          const pdf = `https://arxiv.org/pdf/${arxivId}.pdf`;
          icons.push(`<a href="${pdf}" target="_blank" rel="noopener noreferrer" aria-label="arXiv PDF" class="inline-flex items-center gap-1 text-xs text-slate-500 hover:text-brand"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 464 512\" class=\"h-5 w-5\" fill=\"currentColor\">` +
            `<path class="st0" d="M378.413,0H208.297h-13.182L185.8,9.314L57.02,138.102l-9.314,9.314v13.176v265.514c0,47.36,38.528,85.895,85.896,85.895h244.811c47.353,0,85.881-38.535,85.881-85.895V85.896C464.294,38.528,425.766,0,378.413,0z M432.497,426.105c0,29.877-24.214,54.091-54.084,54.091H133.602c-29.884,0-54.098-24.214-54.098-54.091V160.591h83.716c24.885,0,45.077-20.178,45.077-45.07V31.804h170.116c29.87,0,54.084,24.214,54.084,54.092V426.105z"/>` +
            `<path class="st0" d="M171.947,252.785h-28.529c-5.432,0-8.686,3.533-8.686,8.825v73.754c0,6.388,4.204,10.599,10.041,10.599c5.711,0,9.914-4.21,9.914-10.599v-22.406c0-0.545,0.279-0.817,0.824-0.817h16.436c20.095,0,32.188-12.226,32.188-29.612C204.136,264.871,192.182,252.785,171.947,252.785z M170.719,294.888h-15.208c-0.545,0-0.824-0.272-0.824-0.81v-23.23c0-0.545,0.279-0.816,0.824-0.816h15.208c8.42,0,13.447,5.027,13.447,12.498C184.167,290,179.139,294.888,170.719,294.888z"/>` +
            `<path class="st0" d="M250.191,252.785h-21.868c-5.432,0-8.686,3.533-8.686,8.825v74.843c0,5.3,3.253,8.693,8.686,8.693h21.868c19.69,0,31.923-6.249,36.81-21.324c1.76-5.3,2.723-11.681,2.723-24.857c0-13.175-0.964-19.557-2.723-24.856C282.113,259.034,269.881,252.785,250.191,252.785z M267.856,316.896c-2.318,7.331-8.965,10.459-18.21,10.459h-9.23c-0.545,0-0.824-0.272-0.824-0.816v-55.146c0-0.545,0.279-0.817,0.824-0.817h9.23c9.245,0,15.892,3.128,18.21,10.46c0.95,3.128,1.62,8.56,1.62,17.93C269.476,308.336,268.805,313.768,267.856,316.896z"/>` +
            `<path class="st0" d="M361.167,252.785h-44.812c-5.432,0-8.7,3.533-8.7,8.825v73.754c0,6.388,4.218,10.599,10.055,10.599c5.697,0,9.914-4.21,9.914-10.599v-26.351c0-0.538,0.265-0.81,0.81-0.81h26.086c5.837,0,9.23-3.532,9.23-8.56c0-5.028-3.393-8.553-9.23-8.553h-26.086c-0.545,0-0.81-0.272-0.81-0.817v-19.425c0-0.545,0.265-0.816,0.81-0.816h32.733c5.572,0,9.245-3.666,9.245-8.553C370.411,256.50,366.738,252.785,361.167,252.785z"/>` +
            `</svg><span class=\"sr-only\">PDF</span></a>`);
        } else {
          // Check for local PDF file based on bib key
          const localPdf = `/assets/pdf/${p._key}.pdf`;
          icons.push(`<a href="${localPdf}" target="_blank" rel="noopener noreferrer" aria-label="Local PDF" class="inline-flex items-center gap-1 text-xs text-slate-500 hover:text-brand"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 464 512\" class=\"h-5 w-5\" fill=\"currentColor\">` +
            `<path class="st0" d="M378.413,0H208.297h-13.182L185.8,9.314L57.02,138.102l-9.314,9.314v13.176v265.514c0,47.36,38.528,85.895,85.896,85.895h244.811c47.353,0,85.881-38.535,85.881-85.895V85.896C464.294,38.528,425.766,0,378.413,0z M432.497,426.105c0,29.877-24.214,54.091-54.084,54.091H133.602c-29.884,0-54.098-24.214-54.098-54.091V160.591h83.716c24.885,0,45.077-20.178,45.077-45.07V31.804h170.116c29.87,0,54.084,24.214,54.084,54.092V426.105z"/>` +
            `<path class="st0" d="M171.947,252.785h-28.529c-5.432,0-8.686,3.533-8.686,8.825v73.754c0,6.388,4.204,10.599,10.041,10.599c5.711,0,9.914-4.21,9.914-10.599v-22.406c0-0.545,0.279-0.817,0.824-0.817h16.436c20.095,0,32.188-12.226,32.188-29.612C204.136,264.871,192.182,252.785,171.947,252.785z M170.719,294.888h-15.208c-0.545,0-0.824-0.272-0.824-0.81v-23.23c0-0.545,0.279-0.816,0.824-0.816h15.208c8.42,0,13.447,5.027,13.447,12.498C184.167,290,179.139,294.888,170.719,294.888z"/>` +
            `<path class="st0" d="M250.191,252.785h-21.868c-5.432,0-8.686,3.533-8.686,8.825v74.843c0,5.3,3.253,8.693,8.686,8.693h21.868c19.69,0,31.923-6.249,36.81-21.324c1.76-5.3,2.723-11.681,2.723-24.857c0-13.175-0.964-19.557-2.723-24.856C282.113,259.034,269.881,252.785,250.191,252.785z M267.856,316.896c-2.318,7.331-8.965,10.459-18.21,10.459h-9.23c-0.545,0-0.824-0.272-0.824-0.816v-55.146c0-0.545,0.279-0.817,0.824-0.817h9.23c9.245,0,15.892,3.128,18.21,10.46c0.95,3.128,1.62,8.56,1.62,17.93C269.476,308.336,268.805,313.768,267.856,316.896z"/>` +
            `<path class="st0" d="M361.167,252.785h-44.812c-5.432,0-8.7,3.533-8.7,8.825v73.754c0,6.388,4.218,10.599,10.055,10.599c5.697,0,9.914-4.21,9.914-10.599v-26.351c0-0.538,0.265-0.81,0.81-0.81h26.086c5.837,0,9.23-3.532,9.23-8.56c0-5.028-3.393-8.553-9.23-8.553h-26.086c-0.545,0-0.81-0.272-0.81-0.817v-19.425c0-0.545,0.265-0.816,0.81-0.816h32.733c5.572,0,9.245-3.666,9.245-8.553C370.411,256.50,366.738,252.785,361.167,252.785z"/>` +
            `</svg><span class=\"sr-only\">PDF</span></a>`);
        }
        
        // Add GitHub code link if available
        const codeUrl = (p.code || '').trim();
        if (codeUrl) {
          icons.push(`<a href="${escapeHTML(codeUrl)}" target="_blank" rel="noopener noreferrer" aria-label="Source Code" class="inline-flex items-center gap-1 text-xs text-slate-500 hover:text-brand"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" class=\"h-5 w-5\" fill=\"currentColor\"><path d=\"M12 .5a12 12 0 00-3.79 23.4c.6.1.82-.26.82-.58v-2.03c-3.34.73-4.04-1.61-4.04-1.61-.55-1.39-1.36-1.76-1.36-1.76-1.11-.76.08-.74.08-.74 1.23.09 1.88 1.26 1.88 1.26 1.09 1.87 2.86 1.33 3.55 1.02.11-.8.43-1.33.78-1.64-2.66-.3-5.46-1.34-5.46-5.98 0-1.32.47-2.4 1.24-3.25-.12-.3-.54-1.5.12-3.12 0 0 1-.32 3.3 1.24a11.44 11.44 0 016 0c2.3-1.56 3.3-1.24 3.3-1.24.66 1.62.24 2.82.12 3.12.77.85 1.24 1.93 1.24 3.25 0 4.66-2.8 5.67-5.48 5.98.44.38.83 1.12.83 2.26v3.35c0 .32.21.69.83.58A12 12 0 0012 .5z\"/></svg><span class=\"sr-only\">Code</span></a>`);
        }
        
        // Add BibTeX export button (uses data-key attribute and is wired up after render)
        icons.push(`<button type=\"button\" data-bib-key=\"${escapeHTML(p._key)}\" class=\"bib-export inline-flex items-center gap-1 text-xs text-slate-500 hover:text-brand\" aria-label=\"Export BibTeX\">` +
          `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" class=\"h-5 w-5\" fill=\"currentColor\"><path d=\"M9 9v-7h7v7.1c0 4.8-4.5 5.4-4.5 5.4l-0.6-1.4c0 0 2-0.3 2.4-1.9 0.4-1.2-0.4-2.2-0.4-2.2h-3.9z\"></path><path d=\"M0 9v-7h7v7.1c0 4.8-4.5 5.4-4.5 5.4l-0.6-1.4c0 0 2-0.3 2.4-1.9 0.4-1.2-0.4-2.2-0.4-2.2h-3.9z\"></path></svg><span class=\"sr-only\">BibTeX</span></button>`);

  if (icons.length === 0) return '';
  return icons.join('');
      };

      // Generate TLDR summaries for each paper
      const getTLDR = (p) => {
        const key = p._key || '';
        const tldrMap = {
          'lykiardopoulou2021improving': 'We show that quantum annealing with YY interactions can outperform classical stoquastic Hamiltonians when the right spin-reversal transformation is chosen. We introduce an optimization protocol to find the optimal transformation.',
          'blunt2022perspective': 'Recent advances in quantum phase estimation algorithms have dramatically reduced the computational resources needed for quantum chemistry calculations from 1000+ years to just days. This makes quantum computing for drug discovery applications much more feasible in the near future.',
          'scivier2024gaussianprocessesprobabilisticestimates': 'We develop a probabilistic method to account for inconsistencies between seismic velocity models when predicting earthquake ground shaking. This 1-D synthetic proof-of-concept shows that accounting for model uncertainty leads to much wider uncertainties in ground motion predictions.'
        };
        return tldrMap[key] || '';
      };

      const renderCard = (p) => {
        const year = p.year || '';
        const title = latexToUnicode(p.title || '');
        const authors = formatAuthors(p.author || p.authors || '');
        const venueRaw = p.journal || p.booktitle || p.publisher || '';
        const venue = latexToUnicode(venueRaw);
  const doi = (p.doi || '').replace(/^(doi:\s*)/i,'');
  const rawUrl = p.url || '';
  const arxivMatch2 = (p.journal || p.note || p.url || p.howpublished || '').match(/arXiv[:\s]?([0-9]{4}\.[0-9]{4,5})(v\d+)?/i);
  const arxivAbs = arxivMatch2 ? `https://arxiv.org/abs/${arxivMatch2[1]}` : '';
  const url = rawUrl || (doi ? `https://doi.org/${doi}` : '') || arxivAbs || '';
        const note = latexToUnicode(p.note || '');
        const cat = p._category || getCategory(p);
        const tldr = getTLDR(p);
        const abstract = latexToUnicode(p.abstract || '');
        const uniqueId = `abstract-${p._key || Math.random().toString(36).substr(2, 9)}`;

        const icons = renderIcons(p);
        
        return `
          <article class="relative p-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800/50 shadow-sm hover:shadow-soft transition ${cat}" data-category="${cat}">
            <!-- Top bar with year and icons -->
            <div class="flex items-center justify-between mb-4">
              <div class="text-sm font-medium text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-800 px-3 py-1.5 rounded-full bg-slate-50 dark:bg-slate-700/50">${escapeHTML(latexToUnicode(year))}</div>
              <div class="flex items-center gap-3">${icons}</div>
            </div>
            <!-- Content below -->
            <h3 class="font-semibold text-slate-900 dark:text-slate-100 leading-snug">
              ${ url ? `<a href="${escapeHTML(url)}" target="_blank" rel="noopener noreferrer" class="hover:text-brand">${escapeHTML(title)}</a>` : escapeHTML(title) }
            </h3>
            <div class="mt-2 text-sm text-slate-600 dark:text-slate-300 break-words">${authors}</div>
            <div class="mt-1 text-sm text-slate-500 dark:text-slate-400">${escapeHTML(venue)}</div>
            ${ tldr ? `<div class="mt-3 text-sm text-slate-700 dark:text-slate-300"><strong>TLDR:</strong> ${escapeHTML(tldr)}</div>` : '' }
            ${ abstract ? `
              <div class="mt-3">
                <button type="button" 
                        class="text-sm text-brand hover:text-brand/80 font-medium cursor-pointer flex items-center gap-1"
                        onclick="toggleAbstract('${uniqueId}')"
                        aria-expanded="false"
                        aria-controls="${uniqueId}">
                  <span class="expand-text">Show abstract</span>
                  <svg class="expand-icon h-4 w-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                  </svg>
                </button>
                <div id="${uniqueId}" class="abstract-content hidden mt-2 text-sm text-slate-600 dark:text-slate-300 leading-relaxed">
                  ${escapeHTML(abstract)}
                </div>
              </div>
            ` : '' }
            ${ note ? `<p class='text-sm mt-3 text-slate-600 dark:text-slate-300'>${escapeHTML(note)}</p>` : '' }
          </article>
        `;
      };

      fetch('/bib/publications.bib', {cache: 'no-cache'}).then(r => {
        if (!r.ok) throw new Error('Failed to fetch publications.bib');
        return r.text();
      }).then(text => {
        const pubs = parseBib(text);
        // convert LaTeX in fields where useful
        pubs.forEach(p => {
          // attempt to normalize year number
          p._yearNum = parseInt((p.year||'').match(/\d{4}/)?.[0] || '0', 10) || 0;
          // compute category for filtering
          p._category = getCategory(p);
        });
        pubs.sort((a,b) => (b._yearNum - a._yearNum) || (a._key || '').localeCompare(b._key || ''));
        if (pubs.length === 0) {
          wrap.innerHTML = '<p class="text-sm text-slate-600 dark:text-slate-300">No publications found in <code>/bib/publications.bib</code>.</p>';
          return;
        }
        wrap.innerHTML = pubs.map(renderCard).join('');

        // Attach BibTeX export handlers
        const makeBibString = (entry) => {
          const lines = [];
          const t = entry._type || 'article';
          const k = entry._key || 'key';
          lines.push(`@${t}{${k},`);
          Object.keys(entry).forEach(f => {
            if (f.startsWith('_')) return;
            const val = entry[f];
            // wrap in braces and preserve original spacing
            lines.push(`  ${f} = {${val}},`);
          });
          // replace trailing comma on last field
          if (lines.length > 1) {
            const last = lines.pop();
            lines.push(last.replace(/,$/, ''));
          }
          lines.push('}');
          return lines.join('\n');
        };

        document.querySelectorAll('.bib-export').forEach(btn => {
          btn.addEventListener('click', (e) => {
            const key = btn.getAttribute('data-bib-key');
            const entry = pubs.find(p => p._key === key);
            if (!entry) return;
            const bib = makeBibString(entry);
            const blob = new Blob([bib], {type: 'text/plain;charset=utf-8'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${entry._key || 'publication'}.bib`;
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
          });
        });

        // Init simple filter buttons: show/hide cards by data-category
        const filtersWrap = document.getElementById('pub-filters');
        if (filtersWrap) {
          const buttons = Array.from(filtersWrap.querySelectorAll('.pub-filter'));
          const setActive = (active) => {
            buttons.forEach(b => {
              const on = b.getAttribute('data-filter') === active;
              b.setAttribute('aria-pressed', String(on));
              b.classList.toggle('bg-brand', on);
              b.classList.toggle('text-white', on);
            });
          };
          const applyFilter = (filter) => {
            const cards = Array.from(wrap.querySelectorAll('article[data-category]'));
            cards.forEach(card => {
              const cat = card.getAttribute('data-category');
              card.style.display = (filter === 'all' || filter === cat) ? '' : 'none';
            });
          };
          buttons.forEach(b => {
            b.addEventListener('click', () => {
              const filter = b.getAttribute('data-filter') || 'all';
              setActive(filter);
              applyFilter(filter);
            });
          });
          // Ensure initial filter state applies (All)
          applyFilter('all');
        }

        // Add abstract toggle functionality
        window.toggleAbstract = function(id) {
          const content = document.getElementById(id);
          const button = document.querySelector(`[aria-controls="${id}"]`);
          if (!content || !button) return;
          
          const isExpanded = button.getAttribute('aria-expanded') === 'true';
          const newState = !isExpanded;
          
          button.setAttribute('aria-expanded', String(newState));
          content.classList.toggle('hidden', !newState);
          
          const expandText = button.querySelector('.expand-text');
          const expandIcon = button.querySelector('.expand-icon');
          
          if (expandText) {
            expandText.textContent = newState ? 'Hide abstract' : 'Show abstract';
          }
          if (expandIcon) {
            expandIcon.style.transform = newState ? 'rotate(180deg)' : 'rotate(0deg)';
          }
        };
      }).catch(err => {
        console.error('Could not load publications.bib', err);
        wrap.innerHTML = `<p class="text-sm text-rose-600 dark:text-rose-400">Failed to load publications: ${escapeHTML(err.message)}</p>`;
      });
    })();

    // GitHub Repositories: fetch pinned repos and display with descriptions
    (function loadGitHubRepos() {
      const reposContainer = document.getElementById('repos');
      if (!reposContainer) return;

      // Known pinned repositories (manually maintained list)
      const pinnedRepoNames = [
        'gp-prob-earthquake-shaking',
        'intelligent-earth-cdt-earthquakes-gp',
        'equinox-nn-example',
        'neural-process-example'
      ];

      // Function to get repository description
      const getRepoDescription = (repo) => {
        if (repo.description && repo.description.trim()) {
          return repo.description.trim();
        }
        return 'Research software and tools.';
      };

      // GitHub API URL for user repositories
      const username = 'sscivier';
      const apiUrl = `https://api.github.com/users/${username}/repos?per_page=100`;
      
      fetch(apiUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error(`GitHub API responded with status ${response.status}`);
          }
          return response.json();
        })
        .then(repos => {
          // Filter for the specific pinned repositories
          const pinnedRepos = pinnedRepoNames
            .map(name => repos.find(repo => repo.name === name))
            .filter(repo => repo && !repo.fork && !repo.archived);
          
          renderRepositories(pinnedRepos);
        })
      .catch(error => {
        console.error('Error fetching GitHub repositories:', error);
        reposContainer.innerHTML = `
          <div class="col-span-2 text-center p-8">
            <div class="text-sm text-slate-500 mb-2">Unable to load repositories</div>
            <a href="https://github.com/${username}" class="text-brand hover:text-brand-dark text-sm underline">View on GitHub →</a>
          </div>
        `;
      });

      function renderRepositories(repos) {
        if (repos.length === 0) {
          reposContainer.innerHTML = '<div class="col-span-2 text-center text-slate-500 p-8">No repositories found.</div>';
          return;
        }

        const repoCards = repos.map(repo => {
          const description = getRepoDescription(repo);
          const language = repo.language || 'Code';
          const stars = repo.stargazers_count || 0;
          const lastUpdated = new Date(repo.updated_at).toLocaleDateString();

          return `
            <a href="${repo.html_url}" target="_blank" rel="noopener noreferrer" class="block p-5 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800/50 hover:shadow-soft transition-all duration-200 hover:border-brand/30">
              <div class="flex items-start justify-between gap-2 mb-2">
                <div class="text-sm text-brand font-medium">${language}</div>
                <div class="flex items-center gap-3 text-xs text-slate-500">
                  ${stars > 0 ? `<span class="flex items-center gap-1">
                    <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                    </svg>
                    ${stars}
                  </span>` : ''}
                </div>
              </div>
              <div class="font-medium mb-2">${repo.name}</div>
              <p class="text-sm text-slate-600 dark:text-slate-300 leading-relaxed">${description}</p>
              <div class="mt-3 text-xs text-slate-400">Updated ${lastUpdated}</div>
            </a>
          `;
        });

        reposContainer.innerHTML = repoCards.join('');
      }
    })();
  </script>
</body>
</html>
